More functions and nested loops. Finishing what I started with 200%
